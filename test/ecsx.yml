region: 'us-east-1'
accountId: 1234
project: 'ecsx'

clusters:
  ecsx-test-cluster:
    environment: test
    envVars:
      CLUSTER_ENV: test
      APP_ENV: test
    targetGroups:
      - arn: arn:xxx
        port: 3000
        task: mocha
    securityGroups:
      - "sg-1"
    subnets:
      public: [ subnet-1 ]
      private: []
    secrets:
      app: arn:aws:secretsmanager:{{ region }}:{{ accountId }}:secret:{{ project }}/app/test-xxx

tasks:
  web:
    taskRoleArn: 'somerole'
    executionRoleArn: 'somerole'
    image: ''
    command: []
    cpu: 256
    memory: 512
    service: true
    envVars:
      APP_ENV: task-test
      CLUSTER_NAME: "{{ clusterName }}"
    secrets:
      - name: 'app'
        keys:
          - NODE_ENV
          - SOME_VAR
  mocha:
    taskRoleArn: 'somerole'
    executionRoleArn: 'somerole'
    image: ''
    command: []
    cpu: 256
    memory: 512
    service: false
    envVars:
      APP_ENV: task-test
      CLUSTER_NAME: "{{ clusterName }}"
    subnet: private
    secrets:
      - name: 'app'
        keys:
          - NODE_ENV
          - SOME_VAR
